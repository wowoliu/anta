<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>购物车</title>
    <link rel="stylesheet" href="css/cart.css">
    <script src="libs/jquery-1.11.0.js"></script>
</head>
<body>
    
        <!-----------------deng-------------------------->
        <div class="deng">
            <nav>
             <a href="login.html">登陆</a>或
             <a href="reg.html">注册</a>ANTA会员
            </nav>
         </div>
     
     <!-----------------top-------------------------->
         <div class="top">
             <div class="top1 an">
                 <img src="imgs/nav-i-kt.png" alt="">
     
                 <nav id="yy" class="yy">
                     <ul class="yi">
                         <li>男子</li>
                         <li>女子</li>
                         <li>儿童</li>
                         <li>安踏儿童</li>
                         <li>品牌文化</li>
                         <li>观赏视频</li>
                         <li>联系我们</li>
                         
                     </ul>
                     <div class="er">
                     <div>
                         <ul>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                         <ul>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
     
                         </ul>
                         <ul>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                         
                     </div>
                     <div>
                         <ul>
                             <li>wawazhuang</li>
                             <li>女zhuang</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                         <ul>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
     
                         </ul>
                         <ul>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                     </div>
                     <div>
                         <ul>
                             <li>ertong</li>
                             <li>keaing</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                         <ul>
                             <li>ertong</li>
                             <li>keaing</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>>
     
     
                         </ul>
                         <ul>
                             <li>ertong</li>
                             <li>keaing</li>
                             <li>滑板鞋</li>
                             <li>男鞋</li>
                             <li>女鞋</li>
                             <li>滑板鞋</li>
     
                         </ul>
                     </div>
                     
                     </div>
                 </nav>
             </div>
           </div>


           <div class="xuan" id="xuan">
               <h1 class="an">我的购物车</h1>
               <div class="xuan1 an">
                <input type="checkbox" id="checkAll" class="quanxuan">全选
                <ul id="lb">
                    <!-- <li>
                        <input type="checkbox" class="fuxuan" >
                        <img src="imgs/001.gif" alt="">
                        <span class="bb">标题</span><br>
                        <div class="shu">
                            <span>数量:</span>
                            <span class="j">-</span>
                            <span><input type="text" class="num"></span>
                            <span class="jia">+</span>
                        </div>
                        <div class="dan">
                            <span class="price">单价</span><br>
                            <span class="pricezone">单个总价</span><br>
                            <span><input type="button" value="删除"></span>
                        </div>
                   </li> -->
                 </ul> 
                <div id="totalprice">0</div>
               </div>
               
           </div>
         <script>
             
             //查询购物车接口
             $.get("http://jx.xuzhixiang.top/ap/api/cart-list.php",{
                id:32911,
             }).then(data=>{
                let gou = document.getElementById("lb");
                let str ="";
                var sad = data.data
                //let id = sad[id]
                for(let id in sad){
                    str +=` <ul>
                    <li data-id=${sad[id].pid}>
                        <input type="checkbox" class="fuxuan" >
                        <img src="${sad[id].pimg}" alt="">
                        <span class="bb">${sad[id].pdesc}</span><br>
                        <div class="shu">
                            <span>数量:</span>
                            <b class="j" id ="j">-</b>
                            <span><input type="text" class="num" value="${sad[id].pnum}"></span>
                            <i class="jia">+</i>
                        </div>
                        <div class="dan">
                            <span class="price">${sad[id].pprice}</span><br>
                            <span class="pricezone">${sad[id].pprice*sad[id].pnum}</span><br>
                            <span><input type="button" value="删除"></span>
                        </div>
                   </li>
                 </ul>`
                //for(let i=0;i<$(".j").length;i++){
                    $('div').on('click','.j',function(){
                        console.log(1)
                        //更新购物车接口
                         $.get("http://jx.xuzhixiang.top/ap/api/cart-update-num.php",{
                                 uid:32911,
                                 pid:sad[id].pid,
                                 pnum:sad[id].pnum
                             }).then(data=>{
                                 //console.log(data)
                                 $(".num").val($(".num").val()-1);
                                 if($(".num").val($(".num").val())<=1){
                                     $(".num").val($(".num").val())=1;
                                 }
                         })
                     })
                    
                //}
                      
              //减号点击事件
                    // $(".j").click(function(){
                    //     console.log(1)
                    //     //更新购物车接口
                    //     $.get("http://jx.xuzhixiang.top/ap/api/cart-update-num.php",{
                    //             uid:32911,
                    //             pid:sad[id].pid,
                    //             pnum:sad[id].pnum
                    //         }).then(data=>{
                    //             //console.log(data)
                    //             $(".num").val($(".num").val()-1);
                    //             if($(".num").val($(".num").val())<=1){
                    //                 $(".num").val($(".num").val())=1;
                    //             }
                    //     })
                    // })
                    
                    

                     
                  }
               
                 gou.innerHTML = str;
                
                
                 //console.log(data)
             })
            
         </script>

         
         <script>
            $(".yi li:lt(3)").mouseover(function(){
                var index = $(this).index();
                
                $(".er div").eq(index).show().siblings().hide();
    
            })
            $(".yi li:gt(2)").mouseover(function(){
                $(".er div").hide();
            })
            $(".yy").mouseleave(function(){
                $(".er div").hide();
            })
            
        </script>
</body>
</html>